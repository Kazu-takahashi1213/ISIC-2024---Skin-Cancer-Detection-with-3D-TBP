![Joseph KZ - ISIC 2024 - Skin Cancer Detection with 3D-TBP](https://github.com/user-attachments/assets/aca05b7d-5998-4e4f-9236-e0301f97afd1)

# ISIC 2024

このプロジェクトは、皮膚がんかどうかをAIで予測することを目的に作られた診断支援モデルです。特徴的なのは、画像そのものではなく、画像や患者データから「数値」に変換された情報（構造化データ）を使っている点です。

使われる主な情報は次の3つです：

① 患者の基本情報：年齢や病変のサイズ、種類など

② 画像から取り出した特徴（色や形）：がんの特徴に多い色合いやいびつな形など

③ 他の画像AIの診断スコア：すでに学習済みの画像モデルの「がんらしさ」スコア

これらの情報を使い、「この病変はがんである確率は〇〇%」という形で出力します。

モデルは3つのAIを“チームプレイ”で使って判断
このAIモデルの中心は、「アンサンブル学習」という方法です。
これは、1つのAIだけで判断せず、複数のAI（今回は3つ）を組み合わせて最終判断をする手法です。

具体的には次の3つのAIを使っています：

LightGBM（速くて精度が高い）

XGBoost（非常に安定していて信頼性が高い）

CatBoost（性別などのカテゴリ情報に強い）

この3つのAIがそれぞれ「がんである確率」を出し、その平均（重み付き）をとって最終的な予測を行います。これにより、1つのAIに頼るよりも安定して高精度な判断ができるのです。

微小な「ノイズ」でより強く・賢く
さらに、予測に使う特徴量の一部（他のAIモデルのスコア）に、あえてごくわずかなノイズを加えるという工夫も取り入れています。
これを「マジックノイズ」と呼び、モデルが些細な違いにもしっかり対応できるようになり、本番での予測精度が向上しました。

つまりこのプロジェクトでは、

画像をそのまま見るのではなく、画像から意味のある数字（特徴）を取り出して使う

複数のAIを組み合わせて、より賢く・安定して判断する

少しだけ“ノイズ”を入れて、過学習を防ぎ、未知の患者にも強くする

という3つの工夫によって、「高精度な皮膚がん予測」を実現しました。

◎詳細な説明（専門的な内容）
■ 使用したデータの特徴
特徴タイプ	説明
メタデータ	患者ID、年齢、病変サイズ、病変の種類など（CSV形式）
TBP特徴（テクスチャ）	画像から抽出した色空間（LAB）の変化（ΔL, ΔB）、面積、歪み、皮膚との色コントラストなど
外部モデルスコア	事前学習済みのCNN（ImageNetモデル）による悪性度の予測確率（0〜1）

■ モデル構成
アンサンブルモデル（VotingClassifier）：3つの勾配ブースティングモデルを組み合わせて分類精度を上げています。

モデル	重み
LightGBM	0.50
XGBoost	0.45
CatBoost	0.10

Soft Voting：各モデルの「がんである確率」を加重平均して最終判断。

■ 特徴量エンジニアリングと前処理
数値特徴は20種類以上（例：ΔL、ΔB、面積、形状など）

欠損値の処理：平均補完またはゼロ埋め

Magic Noise（マジックノイズ）：

例：±0.0000003 の非常に小さなノイズを外部スコアに加える

目的：モデルの過学習を防ぎ、汎化性能（未知データへの強さ）を上げる

■ 学習方法と評価
StratifiedGroupKFold（5分割）：

患者ごとにグループ化し、データのリークを防止

各分割で良性/悪性のバランスを確保

クラス不均衡対策：

少数派（悪性）のSMOTEによるオーバーサンプリング

多数派（良性）のアンダーサンプリングも併用

評価指標：ROC AUC（各foldで計算→平均）

■ 最終出力と提出形式
submission.csv に予測確率と patient_id を出力

prediction_score：悪性の確率（0〜1）

〇　コンペを終えての感想
このコンペではモデルの構築やマジックノイズなど公開コードを参考にした部分があり、一から全て書いたわけではないが学びが多かった。特に特徴量エンジニアリングの精度に与える重要性やいかにShake uoに対して頑健な構築にしうるかが勝敗を分けることを痛感した。
